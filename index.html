<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TANTI AUGURI AMORE MIO ❤️</title>
  <meta name="description" content="A special gift just for you. Love vouchers." />
  <meta name="theme-color" content="#FFFBE2" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='84'%3E%F0%9F%92%96%3C/text%3E%3C/svg%3E">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#FFFBE2; --ink:#C21807; --card:#FFFAD1;
      --accent:#C21807; --accent-2:#E64747;
      --shadow:0 8px 24px rgba(0,0,0,.08); --radius:16px;
    }
    *{box-sizing:border-box} html,body{margin:0;padding:0}
    body{background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;line-height:1.6}

    /* Hero */
    .hero{position:relative;padding:64px 16px 40px}
    .hero-inner{max-width:960px;margin:0 auto;text-align:center}
    h1{margin:0 0 6px;font-size:clamp(32px,5vw,56px)}
    .subtitle{margin:0 0 24px;font-family:"Dancing Script",cursive;font-size:clamp(22px,3.2vw,34px);font-weight:700}
    #confetti{position:absolute;inset:0;width:100%;height:100%;pointer-events:none}

    /* CTA */
    .cta{display:grid;justify-items:center;gap:12px;margin-top:18px}
    .cta small{font-size:13px;opacity:.9;text-transform:uppercase;letter-spacing:.5px}
    .gift-btn{margin-top:24px;border:0;background:transparent;cursor:pointer;width:160px;height:160px;position:relative}
    .gift-btn svg{width:100%;height:100%;transition:transform .25s ease}
    .gift-btn:hover svg{transform:translateY(-3px)}
    .gift-btn:focus-visible{outline:3px solid #E64747;outline-offset:6px;border-radius:12px}

    /* Sections / vouchers */
    main{max-width:1000px;margin:0 auto;padding:24px 16px 56px}
    section{margin:24px 0;background:rgba(255,255,255,.5);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow)}
    section h2{margin:0 0 8px;text-align:center}
    .vouchers[hidden]{display:none}
    .vouchers{opacity:0;transform:translateY(10px);transition:opacity .28s ease,transform .28s ease}
    .vouchers.reveal{opacity:1;transform:translateY(0)}
    .vouchers-header p{margin:6px auto 16px;font-size:14px;max-width:800px;text-align:center}

    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px}
    .voucher{background:var(--card);border:1px dashed rgba(194,24,7,.55);border-radius:14px;padding:14px;min-height:150px;display:flex;flex-direction:column;gap:10px;position:relative}
    .voucher-title{font-weight:800;text-transform:uppercase;letter-spacing:.3px;margin:0}
    .voucher-body{font-style:italic;margin:0}
    .voucher-body::first-letter{text-transform:uppercase}
    .voucher-meta{display:flex;align-items:center;justify-content:space-between;gap:8px}
    .meta-right{font-size:12px;opacity:.9}
    .redeemBtn{padding:6px 10px;border-radius:999px;border:1px solid rgba(194,24,7,.35);background:rgba(194,24,7,.08);color:var(--ink);cursor:pointer;font-size:12px}
    .voucher[data-redeemed="true"]{opacity:.88;border-style:solid}
    .date-badge{font-size:11px;padding:4px 8px;border-radius:999px;background:rgba(194,24,7,.08);border:1px solid rgba(194,24,7,.25)}

    @media (prefers-reduced-motion:reduce){.vouchers{transition:none;transform:none}}
    @media print{
      body{background:#fff;color:#000} .hero{display:none} main{padding:0}
      section{box-shadow:none;background:#fff} .voucher{background:#fff;border:1px dashed #c00}
      .redeemBtn{display:none}
    }

    /* --- Cute add-ons (stickers + sigillo + fiocco che respira) --- */
    /* Sticker leggero nell’angolo (effetto adesivo traslucido) */
    .voucher::after{
      content:"";
      position:absolute; right:8px; top:-6px;
      width:48px; height:48px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.7) 0 12px, transparent 13px),
        radial-gradient(circle, rgba(226,49,49,.9) 0 65%, rgba(0,0,0,.08) 66% 68%, transparent 69%);
      border-radius:50%;
      transform:rotate(12deg);
      opacity:.18;
      pointer-events:none;
    }
    /* Sigillo di cera (appare sui riscattati) */
    .stamp{
      position:absolute; inset:auto auto 8px 8px;
      width:86px; height:86px;
      opacity:0;
      transform:rotate(-8deg) scale(.8);
      transition:transform .35s ease, opacity .35s ease;
      pointer-events:none;
      filter:drop-shadow(0 2px 3px rgba(0,0,0,.15));
    }
    .voucher[data-redeemed="true"] .stamp{
      opacity:.92;
      transform:rotate(-8deg) scale(1);
    }
    /* Fiocco che “respira” (delicatissimo) */
    #bow{ transform-box: fill-box; transform-origin: center }
    @media (prefers-reduced-motion: no-preference){
      @keyframes bowBreathe{ 0%,100%{ transform: scale(1) } 50%{ transform: scale(1.06) } }
      #bow{ animation: bowBreathe 2600ms ease-in-out infinite }
    }
  </style>
</head>
<body>
  <header class="hero">
    <div class="hero-inner">
      <h1>TANTI AUGURI AMORE MIO ❤️</h1>
      <p class="subtitle">A special gift just for you</p>

      <div class="cta">
        <small>CLICCA PER SPACCHETTARE IL TUO REGALO</small>

        <!-- Bottone pacchetto -->
        <button id="openGift" class="gift-btn" aria-controls="vouchers" aria-expanded="false" aria-label="Apri il regalo e mostra i voucher" onclick="window.openGift && window.openGift()">
          <!-- Pacchetto con fiocco più realistico -->
          <svg viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
            <!-- ombra -->
            <ellipse cx="64" cy="115" rx="38" ry="8" fill="rgba(0,0,0,.10)"/>
            <!-- scatola -->
            <rect x="20" y="46" width="88" height="64" rx="8" fill="#C21807"/>
            <rect x="20" y="46" width="88" height="64" rx="8" fill="url(#g1)" opacity=".15"/>
            <!-- coperchio -->
            <rect x="16" y="32" width="96" height="26" rx="8" fill="#E64747"/>
            <rect x="16" y="32" width="96" height="26" rx="8" fill="url(#g2)" opacity=".18"/>
            <!-- nastri -->
            <rect x="60" y="32" width="8" height="78" rx="2" fill="#FFD2D2"/>
            <rect x="16" y="58" width="96" height="8" rx="2" fill="#FFD2D2"/>

            <!-- FIOCCO REALISTICO (id="bow" per animazione) -->
            <g id="bow" transform="translate(64 30)">
              <g filter="url(#dropShadow)">
                <!-- loop sinistro -->
                <path d="M -32,-2
                         C -52,-20 -28,-30 -14,-16
                         C  -6,-8  -8, 6 -20,10
                         C -27,12 -30,6 -32,-2 Z"
                      fill="url(#bowGradL)" stroke="#A81808" stroke-width="0.8"/>
                <!-- loop destro -->
                <path d="M 32,-2
                         C 52,-20 28,-30 14,-16
                         C  6,-8   8, 6 20,10
                         C 27,12  30,6 32,-2 Z"
                      fill="url(#bowGradR)" stroke="#A81808" stroke-width="0.8"/>
                <!-- nodo centrale -->
                <ellipse cx="0" cy="6" rx="7.5" ry="6.5" fill="url(#knotGrad)" stroke="#8F1406" stroke-width="1"/>
                <!-- codine -->
                <path d="M -3,11 L -10,26 L -2,22" fill="url(#tailGrad)" stroke="#991406" stroke-width="0.6"/>
                <path d="M  3,11 L  10,26 L  2,22" fill="url(#tailGrad)" stroke="#991406" stroke-width="0.6"/>
                <!-- highlights sottili -->
                <path d="M -26,-8 C -36,-16 -20,-20 -12,-14" fill="none" stroke="rgba(255,255,255,.35)" stroke-width="1.2" stroke-linecap="round"/>
                <path d="M  26,-8 C  36,-16  20,-20  12,-14" fill="none" stroke="rgba(255,255,255,.35)" stroke-width="1.2" stroke-linecap="round"/>
              </g>
            </g>

            <!-- gradienti e filtri -->
            <defs>
              <!-- luci scatola -->
              <linearGradient id="g1" x1="0" y1="46" x2="0" y2="110">
                <stop offset="0" stop-color="#fff" stop-opacity=".6"/>
                <stop offset="1" stop-color="#000" stop-opacity="0"/>
              </linearGradient>
              <linearGradient id="g2" x1="16" y1="32" x2="112" y2="58">
                <stop offset="0" stop-color="#fff" stop-opacity=".5"/>
                <stop offset="1" stop-color="#000" stop-opacity="0"/>
              </linearGradient>
              <!-- fiocco -->
              <linearGradient id="bowGradL" x1="-40" y1="-24" x2="0" y2="14" gradientUnits="userSpaceOnUse">
                <stop offset="0" stop-color="#FFD7D7"/>
                <stop offset=".5" stop-color="#FFC1C1"/>
                <stop offset="1" stop-color="#E88E8E"/>
              </linearGradient>
              <linearGradient id="bowGradR" x1="40" y1="-24" x2="0" y2="14" gradientUnits="userSpaceOnUse">
                <stop offset="0" stop-color="#FFD7D7"/>
                <stop offset=".5" stop-color="#FFC1C1"/>
                <stop offset="1" stop-color="#E88E8E"/>
              </linearGradient>
              <radialGradient id="knotGrad" cx="0" cy="6" r="10" gradientUnits="userSpaceOnUse">
                <stop offset="0" stop-color="#FFE4E4"/>
                <stop offset=".7" stop-color="#FFC5C5"/>
                <stop offset="1" stop-color="#E69292"/>
              </radialGradient>
              <linearGradient id="tailGrad" x1="0" y1="10" x2="0" y2="28" gradientUnits="userSpaceOnUse">
                <stop offset="0" stop-color="#FFD2D2"/>
                <stop offset="1" stop-color="#E88E8E"/>
              </linearGradient>
              <filter id="dropShadow" x="-100" y="-60" width="200" height="160" color-interpolation-filters="sRGB">
                <feDropShadow dx="0" dy="1.2" stdDeviation="1.5" flood-color="rgba(0,0,0,.25)"/>
              </filter>
            </defs>
          </svg>
        </button>
      </div>
    </div>
    <canvas id="confetti"></canvas>
  </header>

  <main>
    <!-- LOVE VOUCHERS -->
    <section id="vouchers" class="vouchers" hidden>
      <div class="vouchers-header">
        <h2>LOVE VOUCHERS</h2>
        <p><strong>Avvertenze:</strong> Questi voucher potrebbero causare dipendenza affettiva e l'uso improprio potrebbe provocare effetti collaterali come eccesso di dolcezza e amore. Utilizzare con moderazione (forse). Scadenza: illimitata.</p>
      </div>

      <div class="grid" id="voucherGrid">
        <article class="voucher" data-redeemed="false" data-idx="1">
          <header class="voucher-title">GRATTINI</header>
          <p class="voucher-body">Questo voucher dà diritto ad una sessione della durata di 30 minuti di grattini a scelta.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="2">
          <header class="voucher-title">MASSAGGIO RILASSANTE</header>
          <p class="voucher-body">Questo voucher dà diritto ad un massaggio rilassante completo della durata di 60 minuti.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="3">
          <header class="voucher-title">SERATA FILM</header>
          <p class="voucher-body">Questo voucher ti dà il diritto di scegliere un film che vuoi tu, con snack che desideri offerti o cena sul divano.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="4">
          <header class="voucher-title">COMANDI TU</header>
          <p class="voucher-body">Per una giornata intera si farà tutto ciò che desideri, qualsiasi cosa.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="5">
          <header class="voucher-title">COLAZIONE A LETTO</header>
          <p class="voucher-body">La tua colazione a scelta direttamente a letto, utilizzare il voucher con anticipo.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="6">
          <header class="voucher-title">CHEF PERSONALE</header>
          <p class="voucher-body">Utilizzando questo voucher, il beneficiario potrà godere di una cena a scelta preparata dal partner che si dovrà occupare di tutto, dalla spesa alla pulizia della cucina.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="7">
          <header class="voucher-title">FANTASIA PICCANTE</header>
          <p class="voucher-body">Questo buono dà il diritto alla realizzazione di qualsiasi fantasia da parte del partner.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="8">
          <header class="voucher-title">BOCCONOTTO NOW</header>
          <p class="voucher-body">Questo voucher dà il diritto a ricevere nell'immediato un bocconotto.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="9">
          <header class="voucher-title">GAME NIGHT</header>
          <p class="voucher-body">Serata game a scelta, che siano giochi da tavola, giochi online o bowling.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="10">
          <header class="voucher-title">CINEMA</header>
          <p class="voucher-body">Questo buono dà il diritto di usufruire di una serata cinema con film a scelta, tutto offerto.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>

        <!-- NUOVI VOUCHER -->
        <article class="voucher" data-redeemed="false" data-idx="11">
          <header class="voucher-title">GELATINO</header>
          <p class="voucher-body">Questo voucher permette di farsi prendere un gelato a scelta in qualsiasi momento.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="12">
          <header class="voucher-title">BOOK LOVER</header>
          <p class="voucher-body">Questo voucher dà la possibilità di ricevere un libro a scelta in regalo.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="13">
          <header class="voucher-title">CIOCCOLATINO</header>
          <p class="voucher-body">Questo voucher è utilizzabile per farsi prendere un cioccolatino a scelta in qualsiasi momento.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
      </div>
    </section>
  </main>

  <script>
    /* ==== Apertura regalo (robusto) ==== */
    function openGift(){
      try{
        const sec=document.getElementById("vouchers");
        if(!sec) return;
        sec.hidden=false;
        void sec.offsetHeight; // trigger transizione
        sec.classList.add("reveal");
        const btn=document.getElementById("openGift");
        if(btn) btn.setAttribute("aria-expanded","true");
        sec.scrollIntoView({behavior:"smooth", block:"start"});
        burstConfetti(); // esplosione extra
      }catch(e){ console.error(e); }
    }
    // Fallback: anche con addEventListener
    document.addEventListener("DOMContentLoaded",()=>{
      const btn=document.getElementById("openGift");
      if(btn) btn.addEventListener("click", openGift);
      loadState();
      startConfetti(); // confetti leggeri sempre attivi
      window.openGift = openGift; // esponi per inline onclick
    });

    /* ==== Utilità data ==== */
    function todayIT(){
      const d=new Date();
      return `${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}/${d.getFullYear()}`;
    }
    function isValidITDate(str){
      if(!/^\d{2}\/\d{2}\/\d{4}$/.test(str)) return false;
      const [dd,mm,yyyy]=str.split("/").map(n=>parseInt(n,10));
      const dt=new Date(yyyy,mm-1,dd);
      return dt.getFullYear()===yyyy&&dt.getMonth()===(mm-1)&&dt.getDate()===dd;
    }

    /* ==== Cute: Sigillo di cera ==== */
    function createStampEl(){
      const wrap = document.createElement("div");
      wrap.className = "stamp";
      wrap.innerHTML = `
        <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <radialGradient id="wax" cx="50%" cy="45%">
              <stop offset="0%" stop-color="#FFCCCC"/>
              <stop offset="65%" stop-color="#E64848"/>
              <stop offset="100%" stop-color="#C21807"/>
            </radialGradient>
          </defs>
          <path d="M50 6
                   C68 6, 92 16, 94 34
                   C96 52, 84 70, 66 74
                   C48 78, 26 74, 16 60
                   C6 46, 10 26, 26 16
                   C36 10, 44 6, 50 6 Z"
                fill="url(#wax)" />
          <path d="M50 62
                   C45 56, 34 49, 34 39
                   C34 33, 39 28, 45 28
                   C48 28, 51 30, 50 33
                   C49 30, 52 28, 55 28
                   C61 28, 66 33, 66 39
                   C66 49, 55 56, 50 62 Z"
                fill="#FFF" opacity=".95"/>
          <text x="50" y="79" font-size="12" font-weight="700" text-anchor="middle"
                fill="rgba(255,255,255,.95)" style="letter-spacing:1px">LOVE</text>
        </svg>
      `;
      return wrap;
    }
    function ensureStamp(card){
      if(!card.querySelector(".stamp")){
        card.appendChild(createStampEl());
      }
    }

    /* ==== Stato vouchers ==== */
    function loadState(){
      document.querySelectorAll(".voucher").forEach(v=>{
        const idx=v.dataset.idx;
        const redeemed=localStorage.getItem(`voucher_${idx}_redeemed`)==="1";
        const date=localStorage.getItem(`voucher_${idx}_date`)||"";
        const btn=v.querySelector(".redeemBtn");
        const meta=v.querySelector(".meta-right");
        if(redeemed){
          v.dataset.redeemed="true";
          if(btn) btn.textContent="Riscattato";
          if(date) meta.innerHTML=`<span class="date-badge">Riscattato il: ${date}</span>`;
          ensureStamp(v); // mostra sigillo anche al reload
        }
      });
    }

    document.addEventListener("click",(e)=>{
      const t=e.target;
      if(!(t && t.classList && t.classList.contains("redeemBtn"))) return;
      const card=t.closest(".voucher");
      const idx=card.dataset.idx;
      const meta=card.querySelector(".meta-right");
      const already=card.dataset.redeemed==="true";
      if(!already){
        let date=prompt("Inserisci la data di riscatto (GG/MM/AAAA):", todayIT());
        if(!date) return;
        if(!isValidITDate(date)){ alert("Formato non valido. Usa GG/MM/AAAA."); return; }
        card.dataset.redeemed="true";
        t.textContent="Riscattato";
        localStorage.setItem(`voucher_${idx}_redeemed`,"1");
        localStorage.setItem(`voucher_${idx}_date`,date);
        meta.innerHTML=`<span class="date-badge">Riscattato il: ${date}</span>`;
        ensureStamp(card); // aggiungi sigillo al momento del riscatto
      }
    });

    /* ==== Confetti ==== */
    let confettiCanvas, ctx, confettiPieces=[];
    function startConfetti(){
      confettiCanvas=document.getElementById("confetti");
      if(!confettiCanvas) return;
      ctx=confettiCanvas.getContext("2d");
      resizeConfetti(); window.addEventListener("resize", resizeConfetti);
      // pioggia leggera continua
      confettiPieces = Array.from({length:100}, ()=>spawnPiece(true));
      animateConfetti();
    }
    function resizeConfetti(){
      confettiCanvas.width = confettiCanvas.offsetWidth;
      confettiCanvas.height = confettiCanvas.offsetHeight;
    }
    function spawnPiece(topRandom=false){
      const w=confettiCanvas.width, h=confettiCanvas.height;
      return {
        x: Math.random()*w,
        y: topRandom ? Math.random()*-h : -10,
        r: 4+Math.random()*6,
        d: 1+Math.random()*2,
        t: Math.random()*Math.PI
      };
    }
    function animateConfetti(){
      ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
      for(const p of confettiPieces){
        ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.t);
        ctx.fillStyle = Math.random()>.5 ? "#C21807" : "#E64747";
        ctx.fillRect(-p.r/2,-p.r/2,p.r,p.r*.6);
        ctx.restore();
        p.y += p.d; p.x += Math.sin(p.y/25)*.8; p.t += .02;
        if(p.y > confettiCanvas.height+20){ // ricicla
          p.y = -10; p.x = Math.random()*confettiCanvas.width;
        }
      }
      requestAnimationFrame(animateConfetti);
    }
    function burstConfetti(){
      if(!confettiCanvas) return;
      // aggiunge un piccolo burst di pezzi in alto
      for(let i=0;i<60;i++){ confettiPieces.push(spawnPiece(false)); }
      // limita il totale
      if(confettiPieces.length>240) confettiPieces = confettiPieces.slice(-240);
    }
  </script>
</body>
</html>
