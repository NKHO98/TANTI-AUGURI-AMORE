<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TANTI AUGURI AMORE MIO ❤️</title>
  <meta name="description" content="A special gift just for you. Love vouchers." />
  <meta name="theme-color" content="#FFFBE2" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='84'%3E%F0%9F%92%96%3C/text%3E%3C/svg%3E">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#FFFBE2; --ink:#C21807; --card:#FFFAD1;
      --accent:#C21807; --accent-2:#E64747;
      --shadow:0 8px 24px rgba(0,0,0,.08); --radius:16px;
    }
    *{box-sizing:border-box} html,body{margin:0;padding:0}
    body{background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;line-height:1.6}

    /* Hero */
    .hero{position:relative;padding:64px 16px 40px}
    .hero-inner{max-width:960px;margin:0 auto;text-align:center}
    h1{margin:0 0 6px;font-size:clamp(32px,5vw,56px)}
    .subtitle{margin:0 0 24px;font-family:"Dancing Script",cursive;font-size:clamp(22px,3.2vw,34px);font-weight:700}
    #confetti{position:absolute;inset:0;width:100%;height:100%;pointer-events:none}

    /* CTA */
    .cta{display:grid;justify-items:center;gap:12px;margin-top:18px}
    .cta small{font-size:13px;opacity:.9;text-transform:uppercase;letter-spacing:.5px}
    .gift-btn{margin-top:24px;border:0;background:transparent;cursor:pointer;width:140px;height:140px;position:relative}
    .gift-btn svg{width:100%;height:100%;transition:transform .25s ease}
    .gift-btn:hover svg{transform:translateY(-3px)}

    /* Sections / vouchers */
    main{max-width:1000px;margin:0 auto;padding:24px 16px 56px}
    section{margin:24px 0;background:rgba(255,255,255,.5);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow)}
    section h2{margin:0 0 8px;text-align:center}
    .vouchers[hidden]{display:none}
    .vouchers{opacity:0;transform:translateY(10px);transition:opacity .28s ease,transform .28s ease}
    .vouchers.reveal{opacity:1;transform:translateY(0)}
    .vouchers-header p{margin:6px auto 16px;font-size:14px;max-width:800px;text-align:center}

    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:14px}
    .voucher{background:var(--card);border:1px dashed rgba(194,24,7,.55);border-radius:14px;padding:14px;min-height:150px;display:flex;flex-direction:column;gap:10px}
    .voucher-title{font-weight:800;text-transform:uppercase;letter-spacing:.3px;margin:0}
    .voucher-body{font-style:italic;margin:0}
    .voucher-body::first-letter{text-transform:uppercase}
    .voucher-meta{display:flex;align-items:center;justify-content:space-between;gap:8px}
    .meta-right{font-size:12px;opacity:.9}
    .redeemBtn{padding:6px 10px;border-radius:999px;border:1px solid rgba(194,24,7,.35);background:rgba(194,24,7,.08);color:var(--ink);cursor:pointer;font-size:12px}
    .voucher[data-redeemed="true"]{opacity:.88;border-style:solid}
    .date-badge{font-size:11px;padding:4px 8px;border-radius:999px;background:rgba(194,24,7,.08);border:1px solid rgba(194,24,7,.25)}

    @media (prefers-reduced-motion:reduce){.vouchers{transition:none;transform:none}}
    @media print{
      body{background:#fff;color:#000} .hero{display:none} main{padding:0}
      section{box-shadow:none;background:#fff} .voucher{background:#fff;border:1px dashed #c00}
      .redeemBtn{display:none}
    }

    /* Animazione coperchio regalo */
.gift-btn .lid { 
  transform-origin: 64px 40px;          /* perno circa al centro-top */
  transition: transform .45s ease; 
}
.gift-btn.opened .lid {
  transform: translateY(-20px) rotate(-8deg);
}
/* opzionale: leggero sobbalzo della scatola */
.gift-btn.opened svg { transform: translateY(-2px); }  </style>
</head>
<body>
  <header class="hero">
    <div class="hero-inner">
      <h1>TANTI AUGURI AMORE MIO ❤️</h1>
      <p class="subtitle">A special gift just for you</p>

      <div class="cta">
        <small>CLICCA PER SPACCHETTARE IL TUO REGALO</small>

        <!-- Bottone pacchetto: onclick inline + id per fallback -->
        <button id="openGift" class="gift-btn" aria-controls="vouchers" aria-expanded="false" onclick="window.openGift && window.openGift()">
          <!-- Pacchetto realistico SVG con FIOCCO -->
          <svg viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
            <!-- ombra -->
            <ellipse cx="64" cy="114" rx="38" ry="8" fill="rgba(0,0,0,.10)"/>
            <!-- scatola -->
            <rect x="20" y="46" width="88" height="64" rx="8" fill="#C21807"/>
            <rect x="20" y="46" width="88" height="64" rx="8" fill="url(#g1)" opacity=".15"/>
            <!-- coperchio -->
            <rect x="16" y="32" width="96" height="26" rx="8" fill="#E64747"/>
            <rect x="16" y="32" width="96" height="26" rx="8" fill="url(#g2)" opacity=".18"/>
            <!-- nastri -->
            <rect x="60" y="32" width="8" height="78" rx="2" fill="#FFD2D2"/>
            <rect x="16" y="58" width="96" height="8" rx="2" fill="#FFD2D2"/>
            <!-- fiocco centrale + anelli -->
            <g transform="translate(64 30)">
              <!-- anelli fiocco -->
              <path d="M-24,0 C-40,-18 -14,-24 -10,-6 C-8,2 -14,8 -22,6 Z" fill="#FFD2D2"/>
              <path d="M24,0 C40,-18 14,-24 10,-6 C8,2 14,8 22,6 Z" fill="#FFD2D2"/>
              <!-- nodo -->
              <circle cx="0" cy="6" r="5" fill="#FFD2D2" stroke="#9B1505" stroke-width="1.2"/>
              <!-- codine -->
              <path d="M-2,10 L-8,20" stroke="#FFD2D2" stroke-width="3" stroke-linecap="round"/>
              <path d="M2,10 L8,20" stroke="#FFD2D2" stroke-width="3" stroke-linecap="round"/>
            </g>
            <!-- gradienti -->
            <defs>
              <linearGradient id="g1" x1="0" y1="46" x2="0" y2="110">
                <stop offset="0" stop-color="#fff" stop-opacity=".6"/>
                <stop offset="1" stop-color="#000" stop-opacity="0"/>
              </linearGradient>
              <linearGradient id="g2" x1="16" y1="32" x2="112" y2="58">
                <stop offset="0" stop-color="#fff" stop-opacity=".5"/>
                <stop offset="1" stop-color="#000" stop-opacity="0"/>
              </linearGradient>
            </defs>
          </svg>
        </button>
      </div>
    </div>
    <canvas id="confetti"></canvas>
  </header>

  <main>
    <!-- LOVE VOUCHERS -->
    <section id="vouchers" class="vouchers" hidden>
      <div class="vouchers-header">
        <h2>LOVE VOUCHERS</h2>
        <p><strong>Avvertenze:</strong> Questi voucher potrebbero causare dipendenza affettiva e l'uso improprio potrebbe provocare effetti collaterali come eccesso di dolcezza e amore. Utilizzare con moderazione (forse). Scadenza: illimitata.</p>
      </div>

      <div class="grid" id="voucherGrid">
        <article class="voucher" data-redeemed="false" data-idx="1">
          <header class="voucher-title">GRATTINI</header>
          <p class="voucher-body">Questo voucher dà diritto ad una sessione della durata di 30 minuti di grattini a scelta.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="2">
          <header class="voucher-title">MASSAGGIO RILASSANTE</header>
          <p class="voucher-body">Questo voucher dà diritto ad un massaggio rilassante completo della durata di 60 minuti.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="3">
          <header class="voucher-title">SERATA FILM</header>
          <p class="voucher-body">Questo voucher ti dà il diritto di scegliere un film che vuoi tu, con snack che desideri offerti o cena sul divano.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="4">
          <header class="voucher-title">COMANDI TU</header>
          <p class="voucher-body">Per una giornata intera si farà tutto ciò che desideri, qualsiasi cosa.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="5">
          <header class="voucher-title">COLAZIONE A LETTO</header>
          <p class="voucher-body">La tua colazione a scelta direttamente a letto, utilizzare il voucher con anticipo.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="6">
          <header class="voucher-title">CHEF PERSONALE</header>
          <p class="voucher-body">Utilizzando questo voucher, il beneficiario potrà godere di una cena a scelta preparata dal partner che si dovrà occupare di tutto, dalla spesa alla pulizia della cucina.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="7">
          <header class="voucher-title">FANTASIA PICCANTE</header>
          <p class="voucher-body">Questo buono dà il diritto alla realizzazione di qualsiasi fantasia da parte del partner.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="8">
          <header class="voucher-title">BOCCONOTTO NOW</header>
          <p class="voucher-body">Questo voucher dà il diritto a ricevere nell'immediato un bocconotto.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="9">
          <header class="voucher-title">GAME NIGHT</header>
          <p class="voucher-body">Serata game a scelta, che siano giochi da tavola, giochi online o bowling.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
        <article class="voucher" data-redeemed="false" data-idx="10">
          <header class="voucher-title">CINEMA</header>
          <p class="voucher-body">Questo buono dà il diritto di usufruire di una serata cinema con film a scelta, tutto offerto.</p>
          <div class="voucher-meta">
            <button class="redeemBtn" type="button">Riscatta</button>
            <div class="meta-right"></div>
          </div>
        </article>
      </div>
    </section>
  </main>

  <script>
    /* ==== Apertura regalo (robusto) ==== */
    function openGift(){
      try{
        const sec=document.getElementById("vouchers");
        if(!sec) return;
        sec.hidden=false;
        void sec.offsetHeight; // trigger transizione
        sec.classList.add("reveal");
        const btn=document.getElementById("openGift");
        if(btn) btn.setAttribute("aria-expanded","true");
        sec.scrollIntoView({behavior:"smooth"});
        burstConfetti(); // esplosione extra
      }catch(e){ console.error(e); }
    }
    // Fallback: anche con addEventListener
    document.addEventListener("DOMContentLoaded",()=>{
      const btn=document.getElementById("openGift");
      if(btn) btn.addEventListener("click", openGift);
      loadState();
      startConfetti(); // confetti leggeri sempre attivi
    });

    /* ==== Utilità data ==== */
    function todayIT(){
      const d=new Date();
      return `${String(d.getDate()).padStart(2,"0")}/${String(d.getMonth()+1).padStart(2,"0")}/${d.getFullYear()}`;
    }
    function isValidITDate(str){
      if(!/^\d{2}\/\d{2}\/\d{4}$/.test(str)) return false;
      const [dd,mm,yyyy]=str.split("/").map(n=>parseInt(n,10));
      const dt=new Date(yyyy,mm-1,dd);
      return dt.getFullYear()===yyyy&&dt.getMonth()===(mm-1)&&dt.getDate()===dd;
    }

    /* ==== Stato vouchers ==== */
    function loadState(){
      document.querySelectorAll(".voucher").forEach(v=>{
        const idx=v.dataset.idx;
        const redeemed=localStorage.getItem(`voucher_${idx}_redeemed`)==="1";
        const date=localStorage.getItem(`voucher_${idx}_date`)||"";
        const btn=v.querySelector(".redeemBtn");
        const meta=v.querySelector(".meta-right");
        if(redeemed){
          v.dataset.redeemed="true";
          if(btn) btn.textContent="Riscattato";
          if(date) meta.innerHTML=`<span class="date-badge">Riscattato il: ${date}</span>`;
        }
      });
    }

    document.addEventListener("click",(e)=>{
      if(!e.target.classList.contains("redeemBtn")) return;
      const card=e.target.closest(".voucher");
      const idx=card.dataset.idx;
      const meta=card.querySelector(".meta-right");
      const already=card.dataset.redeemed==="true";
      if(!already){
        let date=prompt("Inserisci la data di riscatto (GG/MM/AAAA):", todayIT());
        if(!date) return;
        if(!isValidITDate(date)){ alert("Formato non valido. Usa GG/MM/AAAA."); return; }
        card.dataset.redeemed="true";
        e.target.textContent="Riscattato";
        localStorage.setItem(`voucher_${idx}_redeemed`,"1");
        localStorage.setItem(`voucher_${idx}_date`,date);
        meta.innerHTML=`<span class="date-badge">Riscattato il: ${date}</span>`;
      }
    });

    /* ==== Confetti ==== */
    let confettiCanvas, ctx, confettiPieces=[];
    function startConfetti(){
      confettiCanvas=document.getElementById("confetti");
      if(!confettiCanvas) return;
      ctx=confettiCanvas.getContext("2d");
      resizeConfetti(); window.addEventListener("resize", resizeConfetti);
      // pioggia leggera continua
      confettiPieces = Array.from({length:100}, ()=>spawnPiece(true));
      animateConfetti();
    }
    function resizeConfetti(){
      confettiCanvas.width = confettiCanvas.offsetWidth;
      confettiCanvas.height = confettiCanvas.offsetHeight;
    }
    function spawnPiece(topRandom=false){
      const w=confettiCanvas.width, h=confettiCanvas.height;
      return {
        x: Math.random()*w,
        y: topRandom ? Math.random()*-h : -10,
        r: 4+Math.random()*6,
        d: 1+Math.random()*2,
        t: Math.random()*Math.PI
      };
    }
    function animateConfetti(){
      ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
      for(const p of confettiPieces){
        ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.t);
        ctx.fillStyle = Math.random()>.5 ? "#C21807" : "#E64747";
        ctx.fillRect(-p.r/2,-p.r/2,p.r,p.r*.6);
        ctx.restore();
        p.y += p.d; p.x += Math.sin(p.y/25)*.8; p.t += .02;
        if(p.y > confettiCanvas.height+20){ // ricicla
          p.y = -10; p.x = Math.random()*confettiCanvas.width;
        }
      }
      requestAnimationFrame(animateConfetti);
    }
    function burstConfetti(){
      if(!confettiCanvas) return;
      // aggiunge un piccolo burst di pezzi in alto
      for(let i=0;i<60;i++){ confettiPieces.push(spawnPiece(false)); }
      // limita il totale
      if(confettiPieces.length>240) confettiPieces = confettiPieces.slice(-240);
    }
  </script>
</body>
</html>
